{% extends 'base.html' %}

{% block container %}

{% if not data %}

    <form method="post">
        <h2 class="subtitle">
            Create new
        </h2>
        <p class="help has-text-left">Write your secret</p>
        <div class="field">
            <p class="control">
            <textarea class="textarea" name="inputSecret" id="inputSecret" rows="5" placeholder="(Tip: for added security, avoid telling what is the use of the secret you're sharing. Explain it in your email, with the link generated by Shhh.)" autocomplete="off" required></textarea>
            </p>
        </div>
        <p class="help has-text-left">Auto-destroy in</p>
        <div class="field">
            <div class="control ">
                <div class="select">
                    <select id="expiresValue" name="expiresValue">
                        <option value="1">1 day</option>
                        <option value="2">2 days</option>
                        <option value="3">3 days</option>
                        <option value="7">1 week</option>
                    </select>
                </div>
            </div>
        </div>
        <p class="help has-text-left">Passphrase to open secret</p>
        <div class="field is-grouped">
            <p class="control is-expanded">
            <input class="input" name="passPhrase" type="text" placeholder="Passphrase" autocomplete="off" required>
            <p class="control">
            <input type="submit" class="button is-primary" value="Go">
            </p>
        </div>
    </form>

{% else %}

    <div class="field has-addons">
        <div class="control is-expanded">
            <input class="input" type="text" id="link" value="{{ data.link }}" readonly>
        </div>
        <div class="control">
            <button id="copy" class="button is-warning">Copy</button>
        </div>
    </div>
    <p class="info">Send this link along with the passphrase to your recipient.
    This link will expire on <b>{{ data.expires }}.</b> Also note that as soon
    as someone decrypt the message, <b>it will be deleted forever ðŸ”¥</b></p>

{% endif %}

{% endblock %}

{% block js %}

  <script>
    const copy = document.getElementById('copy');
    if ( copy ) {
        copy.addEventListener('click', _ => {
            const link = document.getElementById('link');
            link.select();
            link.setSelectionRange(0, 99999); /* mobile */
            document.execCommand('copy');
            copy.textContent = 'Copied âœ…';
        });
    }
  </script>

{% endblock %}
